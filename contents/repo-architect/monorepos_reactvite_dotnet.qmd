# Monorepo React (vite) + DotNet

I'll help you design a mono-repo structure for a React SPA frontend with a .NET Web API backend. This is a great architecture choice where your .NET API can serve both the static SPA files and API endpoints.

## Recommended Mono-Repo Structure

```
my-app/
â”‚
â”œâ”€â”€ frontend/                    # React TypeScript SPA
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ components/         # Reusable UI components
â”‚   â”‚   â”œâ”€â”€ pages/             # Page components
â”‚   â”‚   â”œâ”€â”€ services/          # API client services
â”‚   â”‚   â”œâ”€â”€ hooks/             # Custom React hooks
â”‚   â”‚   â”œâ”€â”€ utils/             # Utility functions
â”‚   â”‚   â”œâ”€â”€ types/             # TypeScript type definitions
â”‚   â”‚   â”œâ”€â”€ assets/            # Images, fonts, etc.
â”‚   â”‚   â”œâ”€â”€ App.tsx
â”‚   â”‚   â”œâ”€â”€ main.tsx           # Entry point
â”‚   â”‚   â””â”€â”€ index.css
â”‚   â”‚
â”‚   â”œâ”€â”€ public/                # Static assets
â”‚   â”œâ”€â”€ dist/                  # Build output (ignored in git)
â”‚   â”œâ”€â”€ package.json
â”‚   â”œâ”€â”€ tsconfig.json
â”‚   â”œâ”€â”€ vite.config.ts         # Using Vite for build
â”‚   â”œâ”€â”€ .env.development
â”‚   â””â”€â”€ .env.production
â”‚
â”œâ”€â”€ backend/                    # .NET Web API
â”‚   â”œâ”€â”€ MyApp.Api/             # Main API project
â”‚   â”‚   â”œâ”€â”€ Controllers/
â”‚   â”‚   â”œâ”€â”€ Models/
â”‚   â”‚   â”œâ”€â”€ Services/
â”‚   â”‚   â”œâ”€â”€ Data/              # DB context, repositories
â”‚   â”‚   â”œâ”€â”€ Middleware/
â”‚   â”‚   â”œâ”€â”€ Program.cs
â”‚   â”‚   â”œâ”€â”€ appsettings.json
â”‚   â”‚   â”œâ”€â”€ appsettings.Development.json
â”‚   â”‚   â”œâ”€â”€ MyApp.Api.csproj
â”‚   â”‚   â””â”€â”€ wwwroot/           # Frontend build output goes here
â”‚   â”‚
â”‚   â”œâ”€â”€ MyApp.Core/            # Domain models, interfaces
â”‚   â”‚   â”œâ”€â”€ Entities/
â”‚   â”‚   â”œâ”€â”€ Interfaces/
â”‚   â”‚   â””â”€â”€ MyApp.Core.csproj
â”‚   â”‚
â”‚   â”œâ”€â”€ MyApp.Infrastructure/  # Data access, external services
â”‚   â”‚   â”œâ”€â”€ Data/
â”‚   â”‚   â”œâ”€â”€ Repositories/
â”‚   â”‚   â””â”€â”€ MyApp.Infrastructure.csproj
â”‚   â”‚
â”‚   â””â”€â”€ MyApp.sln              # Solution file
â”‚
â”œâ”€â”€ scripts/                    # Build and deployment scripts
â”‚   â”œâ”€â”€ build.sh               # Full build script
â”‚   â”œâ”€â”€ dev.sh                 # Development startup
â”‚   â””â”€â”€ deploy.sh              # Deployment script
â”‚
â”œâ”€â”€ docs/                      # Project documentation
â”œâ”€â”€ .gitignore
â”œâ”€â”€ README.md
â””â”€â”€ package.json               # Root package.json for npm scripts
```

## Key Configuration Files

### 1. Root `package.json` (Orchestration)

```json
{
  "name": "my-app-monorepo",
  "private": true,
  "scripts": {
    "dev": "concurrently \"npm run dev:frontend\" \"npm run dev:backend\"",
    "dev:frontend": "cd frontend && npm run dev",
    "dev:backend": "cd backend/MyApp.Api && dotnet watch run",
    "build": "npm run build:frontend && npm run build:backend",
    "build:frontend": "cd frontend && npm run build && npm run copy-to-backend",
    "build:backend": "cd backend && dotnet build",
    "clean": "rm -rf frontend/dist backend/MyApp.Api/wwwroot/*"
  },
  "devDependencies": {
    "concurrently": "^8.2.0"
  }
}
```

### 2. Frontend `package.json` (Add copy script)

```json
{
  "scripts": {
    "dev": "vite",
    "build": "tsc && vite build",
    "copy-to-backend": "rm -rf ../backend/MyApp.Api/wwwroot/* && cp -r dist/* ../backend/MyApp.Api/wwwroot/"
  }
}
```

### 3. Backend `Program.cs` (Serve SPA)

```csharp
var builder = WebApplication.CreateBuilder(args);

// Add services
builder.Services.AddControllers();
builder.Services.AddEndpointsApiExplorer();
builder.Services.AddSwaggerGen();

var app = builder.Build();

// Configure pipeline
if (app.Environment.IsDevelopment())
{
    app.UseSwagger();
    app.UseSwaggerUI();
}

app.UseHttpsRedirection();

// Serve static files (React SPA)
app.UseDefaultFiles();
app.UseStaticFiles();

// API routes
app.MapControllers();

// Fallback to index.html for SPA routing
app.MapFallbackToFile("index.html");

app.Run();
```

## Development Workflow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”
â”‚                  Development Mode                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚   Frontend   â”‚ :3000    â”‚   Backend    â”‚ :5000     â”‚
â”‚  â”‚   (Vite)     â”‚ â”€â”€â”€â”€â”€â”€>  â”‚  (.NET API)  â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  proxy   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Production Build                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                     â”‚
â”‚  1. Build React â†’ dist/                             â”‚
â”‚  2. Copy dist/* â†’ backend/wwwroot/                  â”‚
â”‚  3. .NET serves both API + SPA from single port     â”‚
â”‚                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Frontend Vite Configuration

```typescript
// frontend/vite.config.ts
import { defineConfig } from 'vite'
import react from '@vitejs/plugin-react'

export default defineConfig({
  plugins: [react()],
  server: {
    port: 3000,
    proxy: {
      '/api': {
        target: 'http://localhost:5000',
        changeOrigin: true
      }
    }
  },
  build: {
    outDir: 'dist',
    assetsDir: 'assets',
    sourcemap: false
  }
})
```

## API Service Example (Frontend)

```typescript
// frontend/src/services/api.ts
const API_BASE_URL = import.meta.env.DEV 
  ? 'http://localhost:5000/api' 
  : '/api';

export class ApiService {
  static async get<T>(endpoint: string): Promise<T> {
    const response = await fetch(`${API_BASE_URL}${endpoint}`);
    if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
    return response.json();
  }
  
  static async post<T>(endpoint: string, data: any): Promise<T> {
    const response = await fetch(`${API_BASE_URL}${endpoint}`, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(data)
    });
    if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
    return response.json();
  }
}
```

## Build Script Example

```bash
#!/bin/bash
# scripts/build.sh

echo "ğŸ—ï¸  Building Full Stack Application..."

# Build frontend
echo "ğŸ“¦ Building frontend..."
cd frontend
npm ci
npm run build

# Copy to backend wwwroot
echo "ğŸ“‹ Copying frontend to wwwroot..."
rm -rf ../backend/MyApp.Api/wwwroot/*
cp -r dist/* ../backend/MyApp.Api/wwwroot/

# Build backend
echo "ğŸ”§ Building backend..."
cd ../backend
dotnet restore
dotnet build -c Release

echo "âœ… Build complete!"
```

## Key Benefits of This Structure

1. **Clear Separation**: Frontend and backend are clearly separated but in the same repo
2. **Single Deployment**: Deploy as a single .NET application serving both API and SPA
3. **Development Experience**: Hot reload for both frontend (Vite) and backend (dotnet watch)
4. **Type Safety**: Share TypeScript types between frontend and generate from C# models
5. **Scalability**: Can easily split into microservices later if needed

## Additional Tips

1. **Environment Variables**: Use `.env` files for frontend and `appsettings.json` for backend
2. **Docker Support**: Add `Dockerfile` in root for containerization
3. **CI/CD**: Use GitHub Actions to automate builds and deployments
4. **Testing**: Add `frontend/tests/` and `backend/MyApp.Tests/` directories
5. **Shared Types**: Consider using tools like NSwag to generate TypeScript clients from your C# API